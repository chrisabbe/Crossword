<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Crossword Editor ‚Äî Around the House</title>
<meta name="description" content="Crossword Editor for numbering and layout adjustments.">
<style>
  :root{--teal:#1f9dbf;--gold:#f5b041;--bg:#faf9f6;--card:#fff;--thin:#ddd;--gold-shade:#faf1de;}
  html,body{margin:0;padding:0;background:var(--bg);font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;display:flex;justify-content:center;}
  .wrap{width:100%;max-width:980px;padding:18px;display:flex;justify-content:center}
  .card{width:100%;max-width:860px;background:var(--card);border-radius:12px;padding:16px;box-shadow:0 8px 20px rgba(0,0,0,.06)}
  .title{color:var(--teal);text-align:center;font-weight:700;margin:0;font-size:clamp(1.05rem,3.6vw,1.6rem)}
  .subtitle{color:#333;text-align:center;margin:6px 0 2px;font-weight:600}
  .instructions{color:#666;text-align:center;margin:0 0 12px;font-size:.95rem;font-style:italic}
  .grid-wrap{display:flex;justify-content:center;margin:10px 0}
  .crossword{display:grid;gap:6px;width:min(700px,95vw);padding:8px;grid-template-columns:repeat(15,1fr)}
  .cell{position:relative;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;background:#fff;
        border:1px solid var(--thin);overflow:hidden;font-family:monospace}
  .cell.block{background:var(--gold-shade)}
  .num{position:absolute;top:4px;left:6px;font-size:16px;font-weight:800;color:#333;cursor:pointer;user-select:none}
  .box{width:100%;height:100%;display:flex;align-items:center;justify-content:center;
       font-size:clamp(18px,3.5vw,28px);font-weight:700;font-family:monospace;text-transform:uppercase;
       background:transparent;outline:none}
  .box:focus{background:#e8f8fb}
  .controls{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;margin-top:14px}
  button{padding:10px 14px;border:none;border-radius:8px;cursor:pointer;font-weight:700}
  .btn-gold{background:var(--gold);color:#222}
  .btn-teal{background:var(--teal);color:#fff}
  textarea{width:100%;height:90px;margin-top:10px;border-radius:8px;border:1px solid var(--thin);padding:6px;font-family:monospace}
</style>
</head>
<body>
<div class="wrap"><div class="card">
<h1 class="title">Crossword Editor</h1>
<div class="subtitle">Around the House</div>
<div class="instructions">Click numbers to edit, type letters to test, or export puzzle data below.</div>

<div class="grid-wrap"><div id="grid" class="crossword"></div></div>

<div class="controls">
  <button id="clearBtn" class="btn-gold">üîÑ Clear Letters</button>
  <button id="resetBtn" class="btn-teal">‚ôªÔ∏è Auto-Renumber</button>
  <button id="copyBtn" class="btn-gold">üìã Copy Puzzle Data</button>
  <button id="openBtn" class="btn-teal">üöÄ Open in Solver</button>
</div>

<textarea id="dataOut" placeholder="Puzzle data appears here after clicking Copy Puzzle Data"></textarea>
</div></div>

<script>
const PUZ_ID='daily-xwd-fallback';
const ROWS=15,COLS=15,centerR0=1,centerC0=4;
const test13x6=[["#","","#","#","#","#"],["#","","#","#","#","#"],["#","","#","","#","#"],["","","","","#","#"],
["#","#","#","","#","#"],["#","#","#","","#","#"],["#","#","","","",""],["#","#","","#","#",""],
["#","#","","#","#",""],["#","#","","#","#","#"],["#","#","","#","#","#"],["#","#","","#","#","#"],
["#","#","","#","#","#"]];
const TEMPLATE=Array.from({length:ROWS},()=>Array(COLS).fill("#"));
for(let r=0;r<test13x6.length;r++)
 for(let c=0;c<test13x6[0].length;c++)
   TEMPLATE[centerR0+r][centerC0+c]=test13x6[r][c]==="#"?"#":"";

function autoNumbers(){
  const n=Array.from({length:ROWS},()=>Array(COLS).fill(0));let k=1;
  for(let r=0;r<ROWS;r++)for(let c=0;c<COLS;c++){
    if(TEMPLATE[r][c]==="#")continue;
    const L=c===0||TEMPLATE[r][c-1]==="#",T=r===0||TEMPLATE[r-1]?.[c]==="#";
    if(L||T)n[r][c]=k++;
  }return n;
}
let numbers=autoNumbers(),answers={};
const grid=document.getElementById('grid');
function build(){
  grid.innerHTML='';grid.style.gridTemplateColumns=`repeat(${COLS},1fr)`;
  for(let r=0;r<ROWS;r++)for(let c=0;c<COLS;c++){
    const cell=document.createElement('div');cell.className='cell';
    if(TEMPLATE[r][c]==="#"){cell.classList.add('block');grid.appendChild(cell);continue;}
    const lab=numbers[r][c];
    if(lab){
      const n=document.createElement('div');n.className='num';n.textContent=lab;
      n.onclick=()=>{const v=prompt('Set number (blank=remove):',lab||'');numbers[r][c]=v.trim()===''?0:parseInt(v)||lab;build();};
      cell.appendChild(n);
    }else{
      cell.ondblclick=()=>{const v=prompt('Add number:','');if(v&&parseInt(v)){numbers[r][c]=parseInt(v);build();}};
    }
    const box=document.createElement('div');box.className='box';
    const key=r+'-'+c;if(answers[key])box.textContent=answers[key];
    box.oninput=()=>{let t=(box.textContent||'').toUpperCase().replace(/[^A-Z]/g,'');
      if(t.length>1)t=t.slice(-1);box.textContent=t;if(t)answers[key]=t;else delete answers[key];};
    cell.appendChild(box);grid.appendChild(cell);
  }
}
build();

document.getElementById('clearBtn').onclick=()=>{answers={};build();};
document.getElementById('resetBtn').onclick=()=>{numbers=autoNumbers();build();};
document.getElementById('copyBtn').onclick=()=>{
  const data=JSON.stringify({numbers,answers});
  const encoded=btoa(unescape(encodeURIComponent(data)));
  document.getElementById('dataOut').value=encoded;
  navigator.clipboard.writeText(encoded).catch(()=>{});
  alert('Puzzle data copied!');
};

// üöÄ Open in Solver button
document.getElementById('openBtn').onclick=()=>{
  const data=JSON.stringify({numbers,answers});
  const encoded=btoa(unescape(encodeURIComponent(data)));
  const solverUrl=`https://chrisabbe.github.io/Crossword-/index.html?data=${encoded}`;
  window.open(solverUrl,'_blank');
};
</script>
</body>
</html>
